<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tech & Games Tracker</title>

<style>
body {
    font-family: Arial, sans-serif;
    background:#0f172a;
    color:white;
    padding:20px;
}

h1 {
    color:#22d3ee;
}

.container {
    display:flex;
    gap:40px;
    flex-wrap:wrap;
}

.card {
    background:#1e293b;
    padding:20px;
    border-radius:12px;
    width:400px;
}

input, select, button {
    width:100%;
    padding:8px;
    margin-top:8px;
    border-radius:6px;
    border:none;
}

button {
    background:#22d3ee;
    font-weight:bold;
    cursor:pointer;
}

.item {
    background:#334155;
    padding:10px;
    margin-top:10px;
    border-radius:6px;
}
</style>
</head>

<body>

<h1>Tech & Game Tracker</h1>

<div class="container">

<!-- GADGET SECTION -->
<div class="card">
<h2>Add Gadget Expense</h2>

<input id="gadgetName" placeholder="Gadget Name">
<input id="gadgetPrice" type="number" placeholder="Price">
<button onclick="addGadget()">Save Gadget</button>

<h3>Saved Gadgets</h3>
<div id="gadgetList"></div>
</div>


<!-- GAME SECTION -->
<div class="card">
<h2>Add Game Disc</h2>

<input id="gameTitle" placeholder="Game Title">
<input id="buyPrice" type="number" placeholder="Buy Price">
<input id="sellPrice" type="number" placeholder="Sell Price (optional)">
<button onclick="addGame()">Save Game</button>

<h3>Saved Games</h3>
<div id="gameList"></div>
</div>

</div>


<!-- Firebase Scripts -->
<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, getDocs, addDoc, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAJtyDC0fI_AzGcKxVHBvF-Focs4doWxMM",
  authDomain: "tech-tracker-87dbc.firebaseapp.com",
  projectId: "tech-tracker-87dbc",
  storageBucket: "tech-tracker-87dbc.firebasestorage.app",
  messagingSenderId: "446800872416",
  appId: "1:446800872416:web:8d094886bf870c9669a185"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

let gadgets = [];
let games = [];
let currentFilter = 'all';

async function loadData() {

    gadgets = [];
    games = [];

    const gSnap = await getDocs(collection(db, "gadgets"));
    gSnap.forEach(d => gadgets.push({firebaseId:d.id, ...d.data()}));

    const gmSnap = await getDocs(collection(db, "games"));
    gmSnap.forEach(d => games.push({firebaseId:d.id, ...d.data()}));

    updateAll();
}

async function saveGadget(gadget) {
    await addDoc(collection(db, "gadgets"), gadget);
    loadData();
}

async function saveGame(game) {
    await addDoc(collection(db, "games"), game);
    loadData();
}

async function deleteGadget(id) {
    if(confirm("Delete this gadget?")) {
        const item = gadgets.find(g=>g.id===id);
        await deleteDoc(doc(db,"gadgets",item.firebaseId));
        loadData();
    }
}

async function deleteGame(id) {
    if(confirm("Delete this game?")) {
        const item = games.find(g=>g.id===id);
        await deleteDoc(doc(db,"games",item.firebaseId));
        loadData();
    }
}


// ---------------- Forms ----------------

document.getElementById('gadget-form').addEventListener('submit', async (e)=>{

    e.preventDefault();

    const gadget = {
        id: Date.now(),
        name: g-name.value,
        category: g-category.value,
        price: parseFloat(g-price.value),
        date: g-date.value,
        notes: g-notes.value
    };

    await saveGadget(gadget);
    e.target.reset();
    g-date.valueAsDate = new Date();
});


document.getElementById('game-form').addEventListener('submit', async (e)=>{

    e.preventDefault();

    const sellPrice = gm-sell-price.value;
    const sellDate = gm-sell-date.value;

    const game = {
        id: Date.now(),
        title: gm-title.value,
        platform: gm-platform.value,
        buyPrice: parseFloat(gm-buy-price.value),
        buyDate: gm-buy-date.value,
        condition: gm-condition.value,
        sellPrice: sellPrice ? parseFloat(sellPrice) : null,
        sellDate: sellDate || null,
        notes: gm-notes.value,
        status: (sellPrice && sellDate) ? 'sold' : 'owned'
    };

    await saveGame(game);
    e.target.reset();
    gm-buy-date.valueAsDate = new Date();
});


// ---------- YOUR EXISTING RENDER LOGIC ----------
/* KEEP EVERYTHING BELOW SAME */

</script>

</body>
</html>
